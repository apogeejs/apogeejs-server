{"fileType":"apogee app js workspace","version":"0.60","references":{"viewState":{"treeState":1,"lists":{"npm module":{"treeState":0}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"bcryptTestWorkspace","children":{"main":{"name":"main","type":"apogee.Folder","children":{"userInfo":{"name":"userInfo","type":"apogee.JsonMember","updateData":{"data":{"email":"sutter@intransix.com","password":"rawPassword"}}},"SALT_ROUNDS":{"name":"SALT_ROUNDS","type":"apogee.JsonMember","updateData":{"data":10}},"createUserForm":{"name":"createUserForm","type":"apogee.FunctionMember","updateData":{"argList":["admin"],"functionBody":"let onSubmit = (formValue,formObject) => {\n    admin.getCommandMessenger().dataCommand(\"userInfo\",formValue);\n}\n\nreturn [\n    {\n        type: \"heading\",\n        text: \"User Info\"\n    },\n    {\n        type: \"textField\",\n        label: \"Email: \",\n        size: 50,\n        key: \"email\"\n    },\n    {\n        type: \"textField\",\n        label: \"Password: \",\n        size: 50,\n        password: true,\n        key: \"password\"\n    },\n    {\n        type: \"submit\",\n        onSubmit: onSubmit,\n        submitLabel: \"Submit\"\n    }\n]","supplementalCode":""}},"encryptedPassword":{"name":"encryptedPassword","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"if((userInfo)&&(userInfo.password)) {\n    let bcrypt = require(\"bcrypt\");\n    let encryptedPromise = new Promise( (resolve,reject) => {\n            bcrypt.hash(userInfo.password, SALT_ROUNDS, function(err, hash) {\n                if(err) {\n                    reject(err);\n                }\n                else {\n                    resolve(hash);\n                }\n        });\n    })\n    return encryptedPromise;\n}\nelse {\n    return \"\";\n}","supplementalCode":""}},"loginForm":{"name":"loginForm","type":"apogee.FunctionMember","updateData":{"argList":["admin"],"functionBody":"let onSubmit = (formValue,formObject) => {\n    admin.getCommandMessenger().dataCommand(\"loginInfo\",formValue);\n}\n\nreturn [\n    {\n        type: \"heading\",\n        text: \"User Info\"\n    },\n    {\n        type: \"textField\",\n        label: \"Email: \",\n        size: 50,\n        key: \"email\"\n    },\n    {\n        type: \"textField\",\n        label: \"Password: \",\n        size: 50,\n        password: true,\n        key: \"password\"\n    },\n    {\n        type: \"submit\",\n        onSubmit: onSubmit,\n        submitLabel: \"Submit\"\n    }\n]","supplementalCode":""}},"loginInfo":{"name":"loginInfo","type":"apogee.JsonMember","updateData":{"data":{"email":"sutter@intransix.com","password":"rawPassword"}}},"passwordMatch":{"name":"passwordMatch","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"if((loginInfo)&&(loginInfo.password)) {\n    let bcrypt = require(\"bcrypt\");\n    let matchPromise = new Promise( (resolve,reject) => {\n        bcrypt.compare(loginInfo.password, encryptedPassword, function(err, result) {\n            if(err) {\n                reject(err);\n            }\n            else {\n                resolve(result);\n            }\n        });\n    })\n    return matchPromise;\n}\nelse {\n    return \"\";\n}","supplementalCode":""}}}}}},"components":{"main":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"BCRYPT Test"}]},{"type":"paragraph","content":[{"type":"text","text":"This workspace is a test of hashing a password using bcrypt."}]},{"type":"paragraph","content":[{"type":"text","text":"To use this, make sure the npm module "},{"type":"text","marks":[{"type":"italic"}],"text":"bcrypt"},{"type":"text","text":" is installed in node_modules."}]},{"type":"heading2","content":[{"type":"text","text":"Create User"}]},{"type":"paragraph","content":[{"type":"text","text":"Here is a form to enter user info:"}]},{"type":"apogeeComponent","attrs":{"name":"createUserForm","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here is the entered user info:"}]},{"type":"apogeeComponent","attrs":{"name":"userInfo","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here we encrypt with bcrypt."}]},{"type":"paragraph","content":[{"type":"text","text":"We require this constant, which I think is a number controlling how much calculation is done. This is to make the algorithm harder as raw computer power increases with the intention of making brute force attacks harder."}]},{"type":"apogeeComponent","attrs":{"name":"SALT_ROUNDS","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here we encrypt the password."}]},{"type":"apogeeComponent","attrs":{"name":"encryptedPassword","id":0,"state":""}},{"type":"paragraph"},{"type":"heading2","content":[{"type":"text","text":"Login"}]},{"type":"paragraph","content":[{"type":"text","text":"Here is a form to log in"}]},{"type":"apogeeComponent","attrs":{"name":"loginForm","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here is the entered user info:"}]},{"type":"apogeeComponent","attrs":{"name":"loginInfo","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here is the password check. (Note, I am checking the password here. I don't check if the correct email address was entered.) "}]},{"type":"apogeeComponent","attrs":{"name":"passwordMatch","id":0,"state":""}}]}},"children":{"userInfo":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"SALT_ROUNDS":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"createUserForm":{"type":"apogeeapp.ActionFormCell","viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Code":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"encryptedPassword":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"loginForm":{"type":"apogeeapp.ActionFormCell","viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Code":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"loginInfo":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"passwordMatch":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true,"tabShowing":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}