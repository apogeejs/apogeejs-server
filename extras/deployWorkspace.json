{"fileType":"apogee app js workspace","version":"0.60","references":{"viewState":{"treeState":1,"lists":{"npm module":{"treeState":0}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"Workspace","children":{"main":{"name":"main","type":"apogee.Folder","children":{"trigger":{"name":"trigger","type":"apogee.JsonMember","updateData":{"data":false}},"triggerReset":{"name":"triggerReset","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"if(trigger === true) {\n    apogeeMessenger.dataUpdate(\"trigger\",false);\n    let deployPromise = getDeployPromise();\n    apogeeMessenger.dataUpdate(\"deployResult\",deployPromise);\n}\nreturn \"ok\";","supplementalCode":""}},"deployResult":{"name":"deployResult","type":"apogee.JsonMember","updateData":{"error":"Error: Error in http request. Status: 500"}},"getDeployPromise":{"name":"getDeployPromise","type":"apogee.FunctionMember","updateData":{"argList":[],"functionBody":"let options = {\n    \"method\": \"post\",\n    \"body\": workspaceJson.value,\n    \"content-type\": \"application/json\"\n}\nreturn apogeeutil.jsonRequest(deployUrl,options);","supplementalCode":""}},"workspaceJson":{"name":"workspaceJson","type":"apogee.Folder","children":{"input":{"name":"input","type":"apogee.JsonMember","updateData":{"data":""}},"value":{"name":"value","type":"apogee.JsonMember","updateData":{"data":{"fileType":"apogee app js workspace","version":"0.60","references":{"viewState":{"treeState":-1,"lists":{"npm module":{"treeState":0}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"ReflectWorkspace","children":{"main":{"name":"main","type":"apogee.INVALIDFolder","children":{"output":{"name":"output","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return { queryParams, headers, body }","supplementalCode":""}},"body":{"name":"body","type":"apogee.JsonMember","updateData":{"data":"xxx"}},"queryParams":{"name":"queryParams","type":"apogee.JsonMember","updateData":{"data":""}},"headers":{"name":"headers","type":"apogee.JsonMember","updateData":{"data":""}},"_workspaceDescriptor_":{"name":"_workspaceDescriptor_","type":"apogee.JsonMember","updateData":{"data":{"name":"reflect"}}},"_endpointDescriptor_processnumber":{"name":"_endpointDescriptor_processnumber","type":"apogee.JsonMember","updateData":{"data":{"name":"basic","inputs":{"body":"main.body","queryParams":"main.queryParams","headers":"main.headers"},"output":"main.output","headerKeys":["Content-Type","XXX","Accept","User-Agent"]}}}}}}},"components":{"main":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Reflector Test"}]},{"type":"apogeeComponent","attrs":{"name":"_workspaceDescriptor_","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"_endpointDescriptor_processnumber","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"This workspace just returns the body sent in."}]},{"type":"apogeeComponent","attrs":{"name":"queryParams","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"These are headers. (Only specified headers are saved here.)"}]},{"type":"apogeeComponent","attrs":{"name":"headers","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"This is the input body value:"}]},{"type":"apogeeComponent","attrs":{"name":"body","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"This is the output."}]},{"type":"apogeeComponent","attrs":{"name":"output","id":0,"state":""}}]}},"children":{"output":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"body":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"queryParams":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"headers":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"_workspaceDescriptor_":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"_endpointDescriptor_processnumber":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":-1,"tabOpened":true,"tabShowing":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}}}}},"deployUrl":{"name":"deployUrl","type":"apogee.JsonMember","updateData":{"data":"http://localhost:8000/admin/deploy"}},"trigger_1":{"name":"trigger_1","type":"apogee.JsonMember","updateData":{"data":false}},"triggerReset_1":{"name":"triggerReset_1","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"if(trigger === true) {\n    apogeeMessenger.dataUpdate(\"trigger_1\",false);\n    let undeployPromise = getUndeployPromise();\n    apogeeMessenger.dataUpdate(\"undeployResult\",undeployPromise);\n}\nreturn \"ok\";","supplementalCode":""}},"deployForm":{"name":"deployForm","type":"apogee.Folder","children":{"input":{"name":"input","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"","supplementalCode":""}},"value":{"name":"value","type":"apogee.JsonMember","updateData":{"data":""}}}},"undeployForm":{"name":"undeployForm","type":"apogee.Folder","children":{"input":{"name":"input","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"","supplementalCode":""}},"value":{"name":"value","type":"apogee.JsonMember","updateData":{"data":""}}},"childrenNotWriteable":true},"undeployResult":{"name":"undeployResult","type":"apogee.JsonMember","updateData":{"error":"Error: Error: Error in http request. Status: 500"}},"undeployUrl":{"name":"undeployUrl","type":"apogee.JsonMember","updateData":{"data":"http://localhost:8000/admin/deploy"}},"getUndeployPromise":{"name":"getUndeployPromise","type":"apogee.FunctionMember","updateData":{"argList":[],"functionBody":"return apogeeutil.jsonRequest(undeployUrl + \"?name=\" + undeployWorkspace);","supplementalCode":""}},"undeployWorkspace":{"name":"undeployWorkspace","type":"apogee.JsonMember","updateData":{"data":"test"}}}}}},"components":{"main":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Deploy Workspace"}]},{"type":"paragraph","content":[{"type":"text","text":"Use this cell to open the workspace."}]},{"type":"apogeeComponent","attrs":{"name":"workspaceJson","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"deployForm","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"trigger","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"triggerReset","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"deployResult","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"undeployForm","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"trigger_1","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"triggerReset_1","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"undeployResult","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"undeployWorkspace","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"deployUrl","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"getDeployPromise","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"undeployUrl","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"getUndeployPromise","id":0,"state":""}},{"type":"paragraph"}]}},"children":{"trigger":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"height":280,"isViewActive":false},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"triggerReset":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"height":280,"isViewActive":false},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"deployResult":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"getDeployPromise":{"type":"apogeeapp.FunctionCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"workspaceJson":{"type":"apogeeapp.NewDataFormCell","layoutCode":"let onFileOpen = (err,data,fileFormat) => {\n    if(err) {\n        return new Error(\"Error reading file data: \" + err);\n    }\n    else {\n        //I think i need better error handling\n        let fileData = fileFormat == \"json\" ? JSON.parse(data) : data;\n        commandMessenger.dataCommand(\"workspaceJson.value\",fileData);\n    }\n}\n\nlet onOpen = formValue => {\n    var {dialog} = require('electron').remote;\n\n    let pathPromise = dialog.showOpenDialog({properties: ['openFile']})\n        .then( fileOpenResult => {\n            if(fileOpenResult.canceled) {\n                //canceled - no action\n                return;\n            }\n        \telse if(fileOpenResult.filePaths.length === 1) {\n        \t    let filePath = fileOpenResult.filePaths[0];\n        \t    var fs = require('fs');\n\t\t\t\tfs.readFile(filePath,'utf8',(err,data) => onFileOpen(err,data,formValue.fileFormat));\n        \t}\n        \telse if(fileOpenResult.filePaths.length > 1) {\n        \t    apogeeUserAlert(\"Multiple file selection not supported!\");\n        \t}\n        \telse {\n        \t    //canceled - no action\n        \t\tapogeeUserAlert(\"Unknown error: no path selected\");\n        \t}\n        })\n        .catch(err => {\n        \tapogeeUserAlert(\"Error getting DB path: \" + err.toString());\n        });\n}\n\nreturn [\n    //oops - this will be saved in this form as value, which we don't wnt\n    //if I make a real one, I can add a separate save location\n    // {\n    //     type: \"radioButtonGroup\",\n    //     label: \"File Format: \",\n    //     entries: [[\"JSON\",\"json\"],[\"Text\",\"text\"]],\n    //     value: \"json\",\n    //     key: \"fileFormat\"\n    // },\n    {\n        type: \"invisible\",\n        value: \"json\",\n        key: \"fileFormat\"\n    },\n    {\n        type: \"submit\",\n        onSubmit: onOpen,\n        submitLabel: \"Open File\"\n    }\n]","validatorCode":"return true","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"form":{"isViewActive":true},"layout":{"height":7000,"isViewActive":false},"validator":{"isViewActive":false,"height":7000},"input":{"isViewActive":false,"height":7000},"inputPrivate":{"isViewActive":false,"height":7000},"value":{"isViewActive":true,"height":280}}}}},"deployUrl":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"trigger_1":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"height":280,"isViewActive":false},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"triggerReset_1":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"height":280,"isViewActive":false},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"deployForm":{"type":"apogeeapp.NewDataFormCell","layoutCode":"let onSubmit = () => {\n    commandMessenger.dataCommand(\"trigger\",true);\n}\n\nlet onCancel = () => {\n    commandMessenger.compoundDataCommand([[\"deployResult\",\"\"],[\"trigger\",false]]);\n}\n\nreturn [\n    {\n        type: \"submit\",\n        submitLabel: \"Deploy\",\n        cancelLabel: \"Clear Deploy Result\",\n        onSubmit: onSubmit,\n        onCancel: onCancel\n    }    \n]","validatorCode":"return true","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"form":{"isViewActive":true},"layout":{"height":7000,"isViewActive":false},"validator":{"isViewActive":false},"input":{"height":7000,"isViewActive":false},"inputPrivate":{"isViewActive":false,"height":7000},"value":{"height":280,"isViewActive":false}}}}},"undeployForm":{"type":"apogeeapp.NewDataFormCell","layoutCode":"let onSubmit = () => {\n    commandMessenger.dataCommand(\"trigger_1\",true);\n}\n\nlet onCancel = () => {\n    commandMessenger.compoundDataCommand([[\"undeployResult\",\"\"],[\"trigger_1\",false]]);\n}\n\nreturn [\n    {\n        type: \"submit\",\n        submitLabel: \"Undeploy\",\n        cancelLabel: \"Clear Undeploy Result\",\n        onSubmit: onSubmit,\n        onCancel: onCancel\n    }    \n]","validatorCode":"return true","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"form":{"isViewActive":true},"layout":{"height":7000,"isViewActive":true},"validator":{"isViewActive":false},"input":{"height":7000,"isViewActive":false},"inputPrivate":{"isViewActive":false,"height":7000},"value":{"height":280,"isViewActive":false}}}}},"undeployResult":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"undeployUrl":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"getUndeployPromise":{"type":"apogeeapp.FunctionCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"undeployWorkspace":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"treeState":1,"tabOpened":true,"tabShowing":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}